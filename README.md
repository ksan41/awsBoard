# freeboard

로그인, 게시글, 댓글 기능이 들어간 간단한 게시판 프로젝트 입니다.

설계부터 구현까지 진행하는 과정을 담았습니다.  



---

## 목차

1. 개발환경
2. 설계
   - 기능분석
   - 도메인 모델, 테이블 설계
   - 화면 설계
3. 기능 구현
4. 웹 계층 개발
5. 단위 테스트 작성

---

## 1. 개발환경

- 운영체제: Window OS (10)
- IDE: IntelliJ IDEA Community (2020.1.4)
- Language: Java (jdk8)
- Framework: SpringBoot (2.3.2 RELEASE)
- WAS: Apache Tomcat 8.5
- Build: Gradle 4.10.2
- Front: Thymeleaf, JavaScript
- Plugins: Lombok
- 형상관리: Git - Git Bash, GitHub Desktop
- 단위테스트: JUnit4

---

## 2. 설계

#### - 기능분석

1. 회원기능
   -회원가입
   -로그인/로그아웃
   -회원정보 수정

2. 게시판
   -게시글 조회
   -게시글 등록
   -게시글 수정
   -게시글 삭제
   -게시글 검색
   -페이징바

3. 댓글
   -댓글 등록
   -댓글 수정
   -댓글 삭제

   

   *기타 요구사항

    -로그인하지 않으면 게시글은 조회만 가능하다.
    -게시글 검색은 작성자(닉네임)/제목/제목+내용으로 검색할 수 있다.
    -게시글을 열람할 때 조회수도 증가한다.



#### 도메인 모델, 테이블 설계

https://drive.google.com/file/d/1Op6dURYX1JgbrNHc164l-NDWLJy5yU9G/view?usp=sharing

회원은 여러 게시글을 작성할 수 있다. (1대 다)
하나의 게시글에는 여러개의 댓글이 달릴 수 있다. (1대 다)



#### *도메인

-회원(member)

-게시글(board)

-댓글(reply)

#### *보조 클래스

-회원권한(Role) : Enum

-게시글상태(BoardStatus) : Enum // 게시글, 댓글 같이 사용

-검색조건(BoardSearch) : Enum // 게시글 검색용 검색조건, 카테고리(작성자, 제목, 제목+내용)



#### 화면 설계

**https://ovenapp.io/view/EmXhOdyDCMGCrPOgfWhHYBhLDwwEqyak/ALD8x**

카카오 오븐 사용



-홈 화면

-로그인 페이지, 회원가입 페이지

-마이페이지

-게시글 작성, 수정, 상세페이지

총 7개 페이지로 구성



# 3. 기능구현

### A. Member(회원) 기능 개발

**SpringSecutiry 사용.

-SecurityConfig

  :  Service에서 비밀번호를 암호화할 수 있도록 BCryptEncoder를 Bean으로 등록했다.

​     SessionFilter를 등록해 front에서 사용자 정보를 "user"로 접근할 수 있도록 했다.

​     사용자의 권한에 따라 url 접근 제한을 두었다.

​     로그인, 로그아웃 설정을 해주었다.



- 회원가입 기능

  -회원가입 시 사용할 MemberDto에 사용자로부터 아이디, 비밀번호, 닉네임을 입력받아 컨트롤러로 전달.

  -서비스에서 BCryptPasswordEncoder를 통해 비밀번호를 암호화 한 뒤, 아이디 중복검사를 수행한다.

   (중복 아이디가 있을 경우엔 등록처리 하지 않고 0l을 반환)

- 회원정보 수정

  -컨트롤러에서 사용자 정보를 받아와 서비스에 넘긴다. 비밀번호와 닉네임을 각각 선택적으로 변경할 수 있으므로, 각각 값이 있을 경우에만 변경처리 하도록 했다.



---

### B. Board(게시글) 도메인 개발

**Querydsl 사용

​	: JPARepository로 처리하기 복잡한 쿼리를 수행하기 위해 사용.

​	 간단한 기능처리는 JPARepository를 사용했다.



- 게시글 조회

  -화면에서 선택한 boardId(식별자)를 받아와 서비스로 넘긴다.

  -이때 조회수도 증가해야 하기 때문에 Board 엔티티를 조회해 온 뒤 조회수를 1 증가시키고

    조회해온 Board를 반환한다.

- 게시글 등록

  -사용자 아이디, 제목, 내용을 컨트롤러에서 받아와 서비스에 넘겼다.

  -서비스에서는 사용자 아이디로 Member 엔티티를 조회해오고, 각 정보를 담아 Board 객체를 생성 후

   BoardRepository(JPA Repository) save 메소드 실행.

- 게시글 수정

  -boardId, 제목과 내용을 받아와 서비스에 넘긴 후, Board 엔티티 내에 작성해둔 update 메소드를 수행한다.

- 게시글 삭제

  -boardId를 받아와 서비스에 넘긴 후, Board 엔티티 내에 작성해둔 delete 메소드를 수행한다.

  (실제로 삭제되지는 않고 boardStatus값만 'DELETE'로 변경해 화면에서 보이지 않도록 했다.)

- 게시글 전체조회, 게시글 검색

  -

---

### C. Reply(댓글) 도메인 개발

- 




# 4. 웹 계층 개발





# 5. 단위 테스트 작성

각 도메인 서비스의 메서드들을 테스트.

JUnit4 사용



- MemberServiceTest (회원 기능 테스트)

  - 회원가입 테스트

  ​       : 아이디, 비밀번호, 닉네임이 주어졌을때 정상적으로 가입이 되는지 테스트한다.

  - 중복 아이디 체크 테스트

    : 가입 시 입력받은 아이디 중복확인 기능을 테스트한다.

  - 회원정보 수정 테스트

    : 새 비밀번호, 닉네임이 주어졌을 때 정상적으로 회원정보 수정이 되는지 테스트한다.

      비밀번호는 저장 시 암호화 되기 때문에 BCryptPasswordEncoder의 matches메소드로

      비교한다.

- BoardServiceTest (게시판 기능 테스트)

  - 글 등록 테스트

    :  회원 아이디, 제목, 내용이 주어졌을 때 정상적으로 게시글이 등록 되는지 테스트한다.

  - 게시글 삭제 테스트

    :  주어진 게시글 번호(pk)에 해당하는 게시글이 삭제되는지 테스트한다.

       (실제로는 status값이 DELETE로 변경된다.)

  - 게시글 수정 테스트

    : 게시글 번호와 수정할 제목과 내용이 주어졌을 때 정상적으로 게시글이 수정되는지 

      테스트한다.

- ReplyServiceTest (댓글 기능 테스트)

  - 댓글 작성 테스트

    :  게시글 번호, 회원아이디(댓글 작성자), 댓글 내용이 주어졌을 때 정상적으로 댓글이 등록 

       되는지 테스트한다. 해당 게시글의 댓글 갯수도 1 증가했는지 확인한다.

  - 댓글 수정 테스트

    : 회원아이디(댓글 작성자), 새 댓글 내용이 주어졌을 때 정상적으로 댓글이 수정되는지 확인한다.

  - 댓글 삭제 테스트

    : 댓글 아이디(pk)가 주어졌을 때 해당 댓글이 삭제되는지 테스트한다.

      (삭제 시 댓글 상태값이 DELETE로 변경되며, 내용은 "삭제된 댓글입니다."로 변경된다.)